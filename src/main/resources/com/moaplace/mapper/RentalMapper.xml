<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
     PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.moaplace.mapper.RentalMapper">
	
	<!-- member_num으로 회원의 대관내역 존재여부 확인 -->
	<select id="rentalExist" resultType="int" parameterType="int">
		select NVL(count(*),0) cnt from rental
		where member_num = #{member_num}
	</select>
	
	<!-- member_num으로 회원의 가장 최근 대관내역 1건 조회 -->
	<select id="recentRental" resultType="com.moaplace.dto.MyRentalDTO" parameterType="int">
		select * from (
		    select r.rental_num,r.regdate,h.hall_name,r.rental_date,r.rental_time,r.rental_state
		    from rental r
		    join hall h on (r.hall_num = h.hall_num)
		    where r.member_num = #{member_num}
		    order by r.rental_num desc
		) where rownum = 1
	</select>
	
</mapper>